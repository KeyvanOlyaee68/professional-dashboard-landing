import{a as ot,b as rt}from"./chunk-URIQVHR2.js";import"./chunk-Y2CAJFX3.js";import{b as it}from"./chunk-3T4PHSKG.js";import"./chunk-LAPY2J4J.js";import{a as tt,b as et}from"./chunk-D2FN2JBF.js";import{d as H,e as J,f as K,g as Q,i as W}from"./chunk-XXJRIRGJ.js";import{f as U}from"./chunk-5RRZI74E.js";import{a as T,b as _,e as w,f as E,g as y,h as N}from"./chunk-KZ4TAMVU.js";import{A as $,D as z,G as X,H as Y,I as Z,b as x,d as v,f as O,g as V,l as j,m as G,n as R,q as B,u as q,w as L,y as P}from"./chunk-D2IK4X32.js";import{Q as A,R as k}from"./chunk-QE25HQRA.js";import"./chunk-DDHFN6XV.js";import{$b as h,Hb as o,Ib as e,Jb as d,Lc as D,Nb as M,Pb as f,Rc as F,Zb as I,_b as r,ab as c,bc as C,fb as m,ma as s,mb as g,na as p,rb as S,yb as u}from"./chunk-INXQJWH5.js";function nt(l,t){if(l&1&&(o(0,"mat-option",16),r(1),e()),l&2){let i=t.$implicit;u("value",i.id),c(),C("",i.name," (",i.code,")")}}var at=class l{constructor(t,i,a,n,b,ct){this.fb=t;this.txService=i;this.accountService=a;this.snackbar=n;this.dialogRef=b;this.data=ct;this.form=this.fb.group({id:[""],accountId:["",v.required],date:[new Date,v.required],debit:[0],credit:[0],description:[""]})}form;accounts=[];ngOnInit(){this.loadAccounts(),this.data?.id&&this.txService.getById(this.data.id).subscribe({next:t=>this.form.patchValue({id:t.id,accountId:t.accountId,date:new Date(t.date),debit:t.debit,credit:t.credit,description:t.description}),error:t=>{console.error(t),this.snackbar.show("\u062E\u0637\u0627 \u062F\u0631 \u0628\u0627\u0631\u06AF\u0630\u0627\u0631\u06CC \u062A\u0631\u0627\u06A9\u0646\u0634")}})}loadAccounts(){this.accountService.getAll().subscribe({next:t=>this.accounts=t,error:t=>console.error(t)})}submit(){if(this.form.invalid)return;let t=this.form.value,i={id:this.data?.id??void 0,accountId:t.accountId??"",date:t.date?t.date.toISOString():new Date().toISOString(),debit:+(t.debit??0),credit:+(t.credit??0),description:t.description??void 0};debugger;(this.data?.id?this.txService.update(i):this.txService.create(i)).subscribe({next:()=>{this.snackbar.show(i.id?"\u062A\u0631\u0627\u06A9\u0646\u0634 \u0648\u06CC\u0631\u0627\u06CC\u0634 \u0634\u062F":"\u062A\u0631\u0627\u06A9\u0646\u0634 \u0627\u0636\u0627\u0641\u0647 \u0634\u062F"),this.dialogRef?.close(!0)},error:n=>{console.error(n),this.snackbar.show("\u062E\u0637\u0627 \u062F\u0631 \u062B\u0628\u062A \u062A\u0631\u0627\u06A9\u0646\u0634")}})}cancel(){this.dialogRef?.close(!1)}static \u0275fac=function(i){return new(i||l)(m(q),m(rt),m(ot),m(it),m(T,8),m(_,8))};static \u0275cmp=g({type:l,selectors:[["app-transaction-form"]],decls:33,vars:6,consts:[["picker",""],["mat-dialog-title",""],["mat-dialog-content",""],[3,"formGroup"],["appearance","fill",1,"full-width",2,"width","100%"],["formControlName","accountId"],[3,"value",4,"ngFor","ngForOf"],["appearance","fill",2,"width","100%"],["matInput","","formControlName","date",3,"matDatepicker"],["matSuffix","",3,"for"],["matInput","","type","number","formControlName","debit"],["matInput","","type","number","formControlName","credit"],["matInput","","formControlName","description","rows","2"],["mat-dialog-actions","","align","end"],["mat-button","",3,"click"],["mat-flat-button","","color","primary",3,"click","disabled"],[3,"value"]],template:function(i,a){if(i&1){let n=M();o(0,"h2",1),r(1),e(),o(2,"div",2)(3,"form",3)(4,"mat-form-field",4)(5,"mat-label"),r(6,"\u062D\u0633\u0627\u0628"),e(),o(7,"mat-select",5),S(8,nt,2,3,"mat-option",6),e()(),o(9,"mat-form-field",7)(10,"mat-label"),r(11,"\u062A\u0627\u0631\u06CC\u062E"),e(),d(12,"input",8)(13,"mat-datepicker-toggle",9)(14,"mat-datepicker",null,0),e(),o(16,"mat-form-field",7)(17,"mat-label"),r(18,"\u0628\u062F\u0647\u06A9\u0627\u0631"),e(),d(19,"input",10),e(),o(20,"mat-form-field",7)(21,"mat-label"),r(22,"\u0628\u0633\u062A\u0627\u0646\u06A9\u0627\u0631"),e(),d(23,"input",11),e(),o(24,"mat-form-field",4)(25,"mat-label"),r(26,"\u0634\u0631\u062D"),e(),d(27,"textarea",12),e()()(),o(28,"div",13)(29,"button",14),f("click",function(){return s(n),p(a.cancel())}),r(30,"\u0627\u0646\u0635\u0631\u0627\u0641"),e(),o(31,"button",15),f("click",function(){return s(n),p(a.submit())}),r(32,"\u0630\u062E\u06CC\u0631\u0647"),e()()}if(i&2){let n=I(15);c(),h(a.form.value.id?"\u0648\u06CC\u0631\u0627\u06CC\u0634 \u062A\u0631\u0627\u06A9\u0646\u0634":"\u0627\u0641\u0632\u0648\u062F\u0646 \u062A\u0631\u0627\u06A9\u0646\u0634"),c(2),u("formGroup",a.form),c(5),u("ngForOf",a.accounts),c(4),u("matDatepicker",n),c(),u("for",n),c(18),u("disabled",a.form.invalid)}},dependencies:[F,D,L,j,x,G,O,V,R,B,N,w,y,E,X,z,P,$,Z,Y,et,tt,U,k,A,Q,H,J,K,W],encapsulation:2})};export{at as TransactionFormComponent};
